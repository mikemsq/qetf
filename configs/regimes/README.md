# Regime Configuration

This directory contains configuration for the regime-based strategy selection system.

## Files

| File | Purpose | Git Tracked |
|------|---------|-------------|
| `thresholds.yaml` | Regime detection thresholds (VIX, trend) | Yes |
| `default_mapping.yaml` | Default regime → strategy mapping | Yes |

## Architecture Decision

See: [ADR-001-regime-based-strategy-selection.md](../../handoffs/architecture/ADR-001-regime-based-strategy-selection.md)

## How It Works

1. **Regime Detection**: Uses `thresholds.yaml` to classify market into 4 regimes
   - Trend dimension: SPY vs 200-day MA (with ±2% hysteresis)
   - Volatility dimension: VIX level (20/25 hysteresis)

2. **Strategy Mapping**: Maps each regime to a strategy
   - Empirical mapping generated by optimizer: `artifacts/optimization/{timestamp}/regime_mapping.yaml`
   - Fallback to `default_mapping.yaml` if no optimization mapping exists

## Updating Thresholds

Changes to `thresholds.yaml` affect production behavior. Before changing:

1. Review historical regime classification with new thresholds
2. Run backtests to validate impact
3. Document rationale in commit message

## Empirical Mapping Updates

The regime → strategy mapping is updated automatically by the optimization process:

```
Quarterly Optimization
    ↓
Regime-Segmented Analysis
    ↓
artifacts/optimization/{timestamp}/regime_mapping.yaml
    ↓
Production uses latest mapping
```

The `default_mapping.yaml` is only used when no optimization has been run.
